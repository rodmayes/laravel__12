import{s as M}from"./index-D_Abxerg.js";import{s as z,a as L}from"./index-C7BBl_90.js";import{s as E}from"./index-WpPmkClo.js";import{s as A,a as J}from"./index-Cx0fiM5w.js";import{s as K}from"./index-cr_iwp2r.js";import{s as Y}from"./index-CmZuPf0w.js";import{s as q,_ as G}from"./AppLayout-e-IMMNZO.js";import{s as H}from"./index-wk5GZ11B.js";import{s as Q}from"./index-BUNM_beL.js";import{r as b,T as W,a as _,o as X,p as Z,b as C,w as a,e as m,d as t,k as v,R as y,f,t as w,c as ee,g as te,h as oe}from"./app-BxDWh9sJ.js";import se from"./Create-C4mmKrFt.js";import ae from"./Edit-B2JQbXWx.js";import{p as re}from"./lodash-ApWI96ZS.js";import{l as le}from"./loadToast-DUYPYtFh.js";import"./index-CNIqUNf5.js";import"./index-CFj-I2Rk.js";import"./index-D9-lTZn9.js";import"./index-DI3l9ENK.js";import"./index-BYnktkzF.js";import"./index-B-3qvxa5.js";import"./index-4MPmKNJR.js";import"./index-4hwA_LJY.js";import"./index-DkWp33hi.js";import"./index-DCn_lInP.js";import"./DropdownLink-TwXiIEwl.js";import"./index-Uyrwedde.js";import"./index-D5jL3_2r.js";const ie={class:"card"},ne={class:"flex flex-wrap gap-2 items-center justify-between"},pe={class:"text-xl font-bold"},me={class:"flex items-center gap-4"},de={key:0},Me={__name:"Index",props:{title:String,filters:Object,items:Object,clubs:Object,perPage:Number},setup(h){const{pickBy:$}=re,l=h;le();const c=b(!1),g=W({}),d=_({...l.items}),o=_({params:{search:l.filters.search,field:l.filters.field,order:l.filters.order,perPage:l.perPage??20,visible:!0,club:null},createOpen:!1,editOpen:!1,resource:null}),i=()=>{const r=$(o.params,e=>e!=null);oe.post(route("playtomic.resources.refreshData"),r).then(e=>{Object.assign(d,e.data.items)})},x=()=>{var r;c.value=!1,g.delete(route("playtomic.resources.destroy",(r=o.resource)==null?void 0:r.id),{preserveScroll:!0,onSuccess:()=>{g.reset(),i()},onError:()=>null,onFinish:()=>null})},V=r=>{o.params.page=r.page+1,o.params.perPage=r.rows,i()},k=r=>{var n;const e=(n=r.multiSortMeta)==null?void 0:n.map(u=>({field:u.field,order:u.order===1?"asc":"desc"}));o.params.sort=JSON.stringify(e),i()},O=()=>i();X(()=>{i()});const S=b([{name:"Visibles",value:!0},{name:"No visibles",value:!1}]),N=b([{label:"Playtomic"},{label:l.title,url:route("playtomic.resources.index")}]);return(r,e)=>{const n=Q,u=H,P=q,D=Y,B=J,I=K,T=A,p=L,U=E,j=z,F=M;return C(),Z(G,{items:N.value},{default:a(()=>[m("div",ie,[t(D,{class:"mb-4"},{start:a(()=>[v(t(n,{label:"Create",onClick:e[0]||(e[0]=s=>o.createOpen=!0),icon:"pi pi-plus",severity:"success",size:"small"},null,512),[[y,r.can(["playtomic.resource_create"])]])]),end:a(()=>[t(u,{modelValue:o.params.club,"onUpdate:modelValue":e[1]||(e[1]=s=>o.params.club=s),options:l.clubs,optionValue:"id",optionLabel:"name",placeholder:"Filter by Club",showClear:"",onChange:i,class:"mr-2"},null,8,["modelValue","options"]),t(P,{modelValue:o.params.visible,"onUpdate:modelValue":e[2]||(e[2]=s=>o.params.visible=s),options:S.value,optionValue:"value",optionLabel:"name",onChange:i},null,8,["modelValue","options"])]),_:1}),t(se,{show:o.createOpen,onClose:e[3]||(e[3]=s=>o.createOpen=!1),title:l.title,onUpdated:i,clubs:l.clubs},null,8,["show","title","clubs"]),t(ae,{show:o.editOpen,onClose:e[4]||(e[4]=s=>o.editOpen=!1),resource:o.resource,title:l.title,onUpdated:i,clubs:l.clubs},null,8,["show","resource","title","clubs"]),t(j,{value:d.data,lazy:"",paginator:"",rows:d.per_page,totalRecords:d.total,first:(d.current_page-1)*d.per_page,rowsPerPageOptions:[5,10,20,50],sortMode:"multiple",sortField:"name",sortOrder:-1,onPage:V,onSort:k,tableStyle:"min-width: 50rem",size:"small"},{header:a(()=>[m("div",ne,[m("span",pe,w(l.title),1),t(T,null,{default:a(()=>[t(B,null,{default:a(()=>e[8]||(e[8]=[m("i",{class:"pi pi-search"},null,-1)])),_:1,__:[8]}),t(I,{modelValue:o.params.search,"onUpdate:modelValue":e[5]||(e[5]=s=>o.params.search=s),placeholder:"Keyword Search",onInput:i},null,8,["modelValue"])]),_:1})])]),paginatorstart:a(()=>[t(n,{type:"button",icon:"pi pi-refresh",text:"",onClick:O})]),empty:a(()=>e[9]||(e[9]=[f(" No data found. ")])),loading:a(()=>e[10]||(e[10]=[f(" Loading data. Please wait. ")])),default:a(()=>[t(p,{header:"No",field:"id",sortable:""}),t(p,{field:"name",header:"Name",sortable:""}),t(p,{field:"playtomic_id",header:"Playtomic Id",sortable:""}),t(p,{field:"priority",header:"Priority",sortable:""}),t(p,{field:"club.name",header:"Club",sortable:""}),t(p,{field:"visible",header:"Visible",sortable:""},{body:a(s=>[t(U,{severity:s.data.visible==1?"":"secondary",rounded:"",icon:s.data.visible==1?"pi pi-eye":"pi pi-eye-slash"},null,8,["severity","icon"])]),_:1}),t(p,{exportable:!1,style:{"min-width":"12rem"}},{body:a(s=>[v(t(n,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:R=>(o.editOpen=!0,o.resource=s.data)},null,8,["onClick"]),[[y,r.can(["playtomic.resource_edit"])]]),v(t(n,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:R=>{c.value=!0,o.resource=s.data}},null,8,["onClick"]),[[y,r.can(["playtomic.resource_delete"])]])]),_:1})]),_:1},8,["value","rows","totalRecords","first"]),t(F,{visible:c.value,"onUpdate:visible":e[7]||(e[7]=s=>c.value=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[t(n,{label:"No",icon:"pi pi-times",text:"",onClick:e[6]||(e[6]=s=>c.value=!1)}),t(n,{label:"Yes",icon:"pi pi-check",onClick:x})]),default:a(()=>[m("div",me,[e[13]||(e[13]=m("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),o.resource?(C(),ee("span",de,[e[11]||(e[11]=f("Are you sure you want to delete ")),m("b",null,w(o.resource.name),1),e[12]||(e[12]=f("?"))])):te("",!0)])]),_:1},8,["visible"])])]),_:1},8,["items"])}}};export{Me as default};
