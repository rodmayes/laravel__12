import{s as w}from"./index-DcVHzutC.js";import{s as B,_ as O}from"./AppLayout-Du8wScWe.js";import{s as $}from"./index-Bvzdffx4.js";import{s as L}from"./index-BWRVypym.js";import{F as m,G as M,M as N,c as f,o as g,w as v,b as j,a as n,H as U,u as y,Y as u,I as T,L as x}from"./app-BXKsk4Hn.js";import I from"./BookingTable-CroE9vbi.js";import R from"./BookingCards-DQNiNaPX.js";import{l as z}from"./loadToast-BVWcLhCU.js";import{p as A}from"./lodash-BgmbBU3H.js";import{g as F,a as G}from"./useFormatters-DGNKrJCF.js";import"./index-DP0y9bu6.js";import"./index-DUdGs5jH.js";import"./index-4sGh9kCV.js";import"./index-DNQpVgdC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-Qjj9tnQ_.js";import"./index-Yo9ZL1-U.js";import"./index-NU00o1A1.js";import"./index-BJiRVnqE.js";import"./index-CMJwYcPe.js";import"./index-DP5ewM03.js";import"./index-Dv-kvlDw.js";import"./index-CmLk1XAt.js";import"./index-DHW-Isfz.js";import"./index-DBCduUWc.js";import"./index-CC7TtCDa.js";import"./index-CuD07zZf.js";import"./index-C5ismy7n.js";import"./index-CHrlQWtL.js";import"./index-BT8mLhEt.js";const H={class:"card"},he={__name:"Index",props:{title:String,filters:Object,clubs:Object,players:Object,timetables:Object,perPage:Number},setup(k){const{pickBy:D}=A;z();const i=k,d=m([]),c=m("card"),_=m([{name:"On time",value:"on-time"},{name:"Closed",value:"closed"},{name:"Time Out",value:"time-out"}]),a=M({params:{search:i.filters.search,perPage:i.perPage??20,club:null,status:"on-time",player:null,timetable:null,page:1,sort:[{field:"started_at",order:"desc"}]},booking:null}),b=m(!1),t=()=>{const o=D(a.params,e=>e!=null);x.post(route("playtomic.bookings.refreshData"),o).then(e=>{d.value={...e.data.items,data:e.data.items.data.map(r=>{const l=F(r);return{...r,modified_at:l?G(l):null}})}})},C=o=>{a.params.page=o.page+1,a.params.perPage=o.rows,t()},V=o=>{var r;const e=(r=o.multiSortMeta)==null?void 0:r.map(l=>({field:l.field,order:l.order===1?"asc":"desc"}));a.params.sort=JSON.stringify(e),t()},p=()=>{u.delete(route("playtomic.bookings.destroy",a.booking.id),{onSuccess:()=>{b.value=!1,t()}})},S=m([{label:"Playtomic"},{label:i.title,url:route("playtomic.bookings.index")}]);return N(t),(o,e)=>{const r=L,l=$,h=B,P=w;return g(),f(O,{items:S.value},{default:v(()=>[j("div",H,[n(P,{class:"mb-4"},{start:v(()=>[U(n(r,{label:"Add Booking",icon:"pi pi-plus",severity:"success",size:"small",onClick:e[0]||(e[0]=s=>y(u).visit(o.route("playtomic.bookings.create")))},null,512),[[T,o.can(["playtomic.booking_create"])]])]),end:v(()=>[n(l,{modelValue:a.params.club,"onUpdate:modelValue":e[1]||(e[1]=s=>a.params.club=s),options:i.clubs,optionLabel:"name",optionValue:"id",placeholder:"Club",class:"mr-2",showClear:"",onChange:t},null,8,["modelValue","options"]),n(l,{modelValue:a.params.player,"onUpdate:modelValue":e[2]||(e[2]=s=>a.params.player=s),options:i.players,optionLabel:"name",optionValue:"id",placeholder:"Player",class:"mr-2",showClear:"",onChange:t},null,8,["modelValue","options"]),n(h,{modelValue:a.params.status,"onUpdate:modelValue":e[3]||(e[3]=s=>a.params.status=s),options:_.value,optionLabel:"name",optionValue:"value",class:"mr-2",onChange:t},null,8,["modelValue","options"]),n(h,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=s=>c.value=s),options:[{label:"Table",value:"table"},{label:"Cards",value:"card"}],optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),_:1}),c.value==="table"?(g(),f(I,{key:0,items:d.value,deleteDialog:b.value,data:a,onPageChange:C,onSortChange:V,onRefresh:t,deleteData:p,router:y(u),can:o.can,onConfirmDelete:p},null,8,["items","deleteDialog","data","router","can"])):(g(),f(R,{key:1,items:d.value,deleteDialog:b.value,data:a,onPageChange:C,onSortChange:V,onRefresh:t,deleteData:p,router:y(u),can:o.can,onConfirmDelete:p},null,8,["items","deleteDialog","data","router","can"]))])]),_:1},8,["items"])}}};export{he as default};
