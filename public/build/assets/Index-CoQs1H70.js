import{s as $}from"./index-C4lvvraB.js";import{s as B}from"./index-CTi-Lker.js";import{s as O,_ as L}from"./AppLayout-CLNBn6lV.js";import{s as M}from"./index-DtIMjM1X.js";import{s as U}from"./index-ChyoiKwM.js";import{r as p,a as j,o as T,i as k,b as c,w as u,e as b,d as n,K as A,u as y,N as f,L as R,c as z,g as E,f as S,t as I,h as J}from"./app-BitM9Esh.js";import K from"./BookingTable-CCf2pURT.js";import Y from"./BookingCards-B0sSr831.js";import{l as q}from"./loadToast-DRzFDdxN.js";import{p as F}from"./lodash-DrivzgbU.js";import{g as G,b as H}from"./useFormatters-UnLyAQ4m.js";import"./index-CxtCzB2E.js";import"./index-CyWtV5jm.js";import"./index-dCAdXrLa.js";import"./DropdownLink-CjHD7zJG.js";import"./index-BRhRa0mV.js";import"./index-BMoRl1xm.js";import"./index-BoR1qmRO.js";import"./index-DYoa0sVQ.js";import"./index-3G90EgRb.js";import"./index-eTxTr7Xb.js";import"./index-JehCiGv6.js";import"./index-Cd1VNrMd.js";import"./index-DQLB793R.js";import"./index-ByyraLLP.js";import"./index-NFWRBMuw.js";import"./index-Dk1_9mQF.js";import"./index-C7q-yZ8e.js";const Q={class:"card"},W={class:"flex items-center gap-4"},X={key:0},xe={__name:"Index",props:{title:String,filters:Object,clubs:Object,players:Object,timetables:Object,perPage:Number},setup(P){const{pickBy:h}=F;q();const m=P,g=p([]),v=p("card"),w=p([{name:"On time",value:"on-time"},{name:"Closed",value:"closed"},{name:"Time Out",value:"time-out"}]),o=j({params:{search:m.filters.search,perPage:m.perPage??20,club:null,status:"on-time",player:null,timetable:null,page:1,sort:[{field:"started_at",order:"desc"}]},booking:null}),i=p(!1),l=()=>{const t=h(o.params,e=>e!=null);J.post(route("playtomic.bookings.refreshData"),t).then(e=>{g.value={...e.data.items,data:e.data.items.data.map(s=>{const r=G(s);return{...s,modified_at:r?H(r):null}})}})},C=t=>{o.params.page=t.page+1,o.params.perPage=t.rows,l()},V=t=>{var s;const e=(s=t.multiSortMeta)==null?void 0:s.map(r=>({field:r.field,order:r.order===1?"asc":"desc"}));o.params.sort=JSON.stringify(e),l()},d=()=>{i.value=!1,f.delete(route("playtomic.bookings.destroy",o.booking.id),{onSuccess:()=>{i.value=!1,l()}})},x=p([{label:"Playtomic"},{label:m.title,url:route("playtomic.bookings.index")}]);return T(l),(t,e)=>{const s=U,r=M,D=O,N=B,_=$;return c(),k(L,{items:x.value},{default:u(()=>[b("div",Q,[n(N,{class:"mb-4"},{start:u(()=>[A(n(s,{label:"Add Booking",icon:"pi pi-plus",severity:"success",size:"small",onClick:e[0]||(e[0]=a=>y(f).visit(t.route("playtomic.bookings.create")))},null,512),[[R,t.can(["playtomic.booking_create"])]])]),end:u(()=>[n(r,{modelValue:o.params.club,"onUpdate:modelValue":e[1]||(e[1]=a=>o.params.club=a),options:m.clubs,optionLabel:"name",optionValue:"id",placeholder:"Club",class:"mr-2",showClear:"",onChange:l},null,8,["modelValue","options"]),n(r,{modelValue:o.params.player,"onUpdate:modelValue":e[2]||(e[2]=a=>o.params.player=a),options:m.players,optionLabel:"name",optionValue:"id",placeholder:"Player",class:"mr-2",showClear:"",onChange:l},null,8,["modelValue","options"]),n(D,{modelValue:o.params.status,"onUpdate:modelValue":e[3]||(e[3]=a=>o.params.status=a),options:w.value,optionLabel:"name",optionValue:"value",class:"mr-2",onChange:l},null,8,["modelValue","options"]),n(D,{modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),options:[{label:"Table",value:"table"},{label:"Cards",value:"card"}],optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),_:1}),v.value==="table"?(c(),k(K,{key:0,items:g.value,deleteDialog:i.value,data:o,onPageChange:C,onSortChange:V,onRefresh:l,deleteData:d,router:y(f),can:t.can,onConfirmDelete:d},null,8,["items","deleteDialog","data","router","can"])):(c(),k(Y,{key:1,items:g.value,deleteDialog:i.value,data:o,onPageChange:C,onSortChange:V,onRefresh:l,deleteData:d,router:y(f),can:t.can,onConfirmDelete:e[5]||(e[5]=a=>{i.value=!0,o.booking=a})},null,8,["items","deleteDialog","data","router","can"]))]),n(_,{visible:i.value,"onUpdate:visible":e[7]||(e[7]=a=>i.value=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:u(()=>[n(s,{label:"No",icon:"pi pi-times",text:"",onClick:e[6]||(e[6]=a=>i.value=!1)}),n(s,{label:"Yes",icon:"pi pi-check",onClick:d})]),default:u(()=>[b("div",W,[e[10]||(e[10]=b("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),o.booking?(c(),z("span",X,[e[8]||(e[8]=S("Are you sure you want to delete ")),b("b",null,I(o.booking.name),1),e[9]||(e[9]=S("?"))])):E("",!0)])]),_:1},8,["visible"])]),_:1},8,["items"])}}};export{xe as default};
