import{s as B}from"./index-BxFLlCx9.js";import{s as N}from"./index-BdoT6J1V.js";import{s as O,_ as L}from"./AppLayout-Cy7CII70.js";import{s as M}from"./index-CittC2c-.js";import{s as U}from"./index-ZbfrLNM9.js";import{F as p,G as j,M as T,c as k,o as c,w as u,b,a as n,H as A,u as y,Y as f,I,f as R,g as Y,e as S,t as z,L as E}from"./app-83c-_KM1.js";import F from"./BookingTable-BJ8MH9U_.js";import G from"./BookingCards-B5JzEip5.js";import{l as H}from"./loadToast-CfjjTVur.js";import{p as J}from"./lodash-PYqBSiCg.js";import{g as q,a as K}from"./useFormatters-DGNKrJCF.js";import"./index-DBbyQEmu.js";import"./index-7HtaOitJ.js";import"./index-BAJXY_Lf.js";import"./index-C99XYocx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-BeVjcmfc.js";import"./index-BVNj8Zz-.js";import"./index-BkdZDdFn.js";import"./index-B8XB_neS.js";import"./index-CZ3Nsf6Z.js";import"./index-DK2wHRHb.js";import"./index-BuiBtt3Y.js";import"./index-CJDdZWEr.js";import"./index-Bc6jSRZt.js";import"./index-D0MEKbWo.js";import"./index-CiBRX_zd.js";import"./index-BWhpOW5S.js";import"./index-Cog68vvZ.js";import"./index-BZar6RjQ.js";const Q={class:"card"},W={class:"flex items-center gap-4"},X={key:0},he={__name:"Index",props:{title:String,filters:Object,clubs:Object,players:Object,timetables:Object,perPage:Number},setup(P){const{pickBy:w}=J;H();const m=P,g=p([]),v=p("card"),x=p([{name:"On time",value:"on-time"},{name:"Closed",value:"closed"},{name:"Time Out",value:"time-out"}]),o=j({params:{search:m.filters.search,perPage:m.perPage??20,club:null,status:"on-time",player:null,timetable:null,page:1,sort:[{field:"started_at",order:"desc"}]},booking:null}),i=p(!1),l=()=>{const t=w(o.params,e=>e!=null);E.post(route("playtomic.bookings.refreshData"),t).then(e=>{g.value={...e.data.items,data:e.data.items.data.map(s=>{const r=q(s);return{...s,modified_at:r?K(r):null}})}})},C=t=>{o.params.page=t.page+1,o.params.perPage=t.rows,l()},V=t=>{var s;const e=(s=t.multiSortMeta)==null?void 0:s.map(r=>({field:r.field,order:r.order===1?"asc":"desc"}));o.params.sort=JSON.stringify(e),l()},d=()=>{i.value=!1,f.delete(route("playtomic.bookings.destroy",o.booking.id),{onSuccess:()=>{i.value=!1,l()}})},_=p([{label:"Playtomic"},{label:m.title,url:route("playtomic.bookings.index")}]);return T(l),(t,e)=>{const s=U,r=M,D=O,$=N,h=B;return c(),k(L,{items:_.value},{default:u(()=>[b("div",Q,[n($,{class:"mb-4"},{start:u(()=>[A(n(s,{label:"Add Booking",icon:"pi pi-plus",severity:"success",size:"small",onClick:e[0]||(e[0]=a=>y(f).visit(t.route("playtomic.bookings.create")))},null,512),[[I,t.can(["playtomic.booking_create"])]])]),end:u(()=>[n(r,{modelValue:o.params.club,"onUpdate:modelValue":e[1]||(e[1]=a=>o.params.club=a),options:m.clubs,optionLabel:"name",optionValue:"id",placeholder:"Club",class:"mr-2",showClear:"",onChange:l},null,8,["modelValue","options"]),n(r,{modelValue:o.params.player,"onUpdate:modelValue":e[2]||(e[2]=a=>o.params.player=a),options:m.players,optionLabel:"name",optionValue:"id",placeholder:"Player",class:"mr-2",showClear:"",onChange:l},null,8,["modelValue","options"]),n(D,{modelValue:o.params.status,"onUpdate:modelValue":e[3]||(e[3]=a=>o.params.status=a),options:x.value,optionLabel:"name",optionValue:"value",class:"mr-2",onChange:l},null,8,["modelValue","options"]),n(D,{modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),options:[{label:"Table",value:"table"},{label:"Cards",value:"card"}],optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),_:1}),v.value==="table"?(c(),k(F,{key:0,items:g.value,deleteDialog:i.value,data:o,onPageChange:C,onSortChange:V,onRefresh:l,deleteData:d,router:y(f),can:t.can,onConfirmDelete:d},null,8,["items","deleteDialog","data","router","can"])):(c(),k(G,{key:1,items:g.value,deleteDialog:i.value,data:o,onPageChange:C,onSortChange:V,onRefresh:l,deleteData:d,router:y(f),can:t.can,onConfirmDelete:e[5]||(e[5]=a=>{i.value=!0,o.booking=a})},null,8,["items","deleteDialog","data","router","can"]))]),n(h,{visible:i.value,"onUpdate:visible":e[7]||(e[7]=a=>i.value=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:u(()=>[n(s,{label:"No",icon:"pi pi-times",text:"",onClick:e[6]||(e[6]=a=>i.value=!1)}),n(s,{label:"Yes",icon:"pi pi-check",onClick:d})]),default:u(()=>[b("div",W,[e[10]||(e[10]=b("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),o.booking?(c(),R("span",X,[e[8]||(e[8]=S("Are you sure you want to delete ")),b("b",null,z(o.booking.name),1),e[9]||(e[9]=S("?"))])):Y("",!0)])]),_:1},8,["visible"])]),_:1},8,["items"])}}};export{he as default};
