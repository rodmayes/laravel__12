import{s as B}from"./index-B5FKt3It.js";import{s as j,a as I}from"./index-CY0KFJ9r.js";import{s as T,a as E}from"./index-DvEu1BkS.js";import{s as F}from"./index-B8iOEnMR.js";import{s as R}from"./index-cSgwQ100.js";import{r as y,T as U,a as K,Y as L,N as w,i as Y,b as C,w as a,e as u,d as r,K as f,L as v,f as d,t as g,c as A,g as q}from"./app-ULZ4ZAEb.js";import{_ as z}from"./AppLayout-ChdgOd20.js";import G from"./Create-BgoNvg-k.js";import H from"./Edit-C-6nZ9ab.js";import J from"./UserPlaytomic-Lr7Fp3OH.js";import{p as M}from"./lodash-DEQDDsa8.js";import{l as Q}from"./loadToast-cPLvEfas.js";import"./index-C70yr8kA.js";import"./index-qbvNbHHM.js";import"./index-yv-qAUCS.js";import"./index-OWtXGIvL.js";import"./index-DFEJBaiI.js";import"./index-Cq-UX9Hm.js";import"./index-DgFixrIt.js";import"./index-_WgtLCcT.js";import"./index-B0phHS61.js";import"./index-XD9PKuO2.js";import"./index-l8FFwk_X.js";import"./DropdownLink-BWcTSRlk.js";import"./index-Bz54wLod.js";import"./index-DOoilzS3.js";import"./index-CJNgEKTO.js";const W={class:"card"},X={class:"flex justify-end"},Z={class:"flex items-center gap-4"},ee={key:0},Pe={__name:"Index",props:{title:String,filters:Object,users:Object,roles:Object,perPage:Number},setup(n){const{_:$,debounce:O,pickBy:k}=M;Q();const l=n,m=y(!1),b=U({}),t=K({params:{search:l.filters.search,field:l.filters.field,order:l.filters.order,perPage:l.perPage,createOpen:!1,editOpen:!1,userPlaytomicOpen:!1},user:null}),x=()=>{var o;m.value=!1,b.delete(route("user.destroy",(o=t.user)==null?void 0:o.id),{preserveScroll:!0,onSuccess:()=>{b.reset()},onError:()=>null,onFinish:()=>null})},_=o=>{w.get(route("user.index"),{page:o.page+1,perPage:o.rows},{preserveState:!0})};L(()=>$.cloneDeep(t.params),O(()=>{let o=k(t.params);w.get(route("user.index"),o,{replace:!0,preserveState:!0,preserveScroll:!0})},150));const h=y([{label:l.title,url:"user"}]);return(o,e)=>{const p=R,N=E,P=F,S=T,i=I,D=j,V=B;return C(),Y(z,{items:h.value},{default:a(()=>[u("div",W,[r(G,{show:t.createOpen,onClose:e[0]||(e[0]=s=>t.createOpen=!1),roles:l.roles,title:l.title},null,8,["show","roles","title"]),r(H,{show:t.editOpen,onClose:e[1]||(e[1]=s=>t.editOpen=!1),roles:l.roles,user:t.user,title:l.title},null,8,["show","roles","user","title"]),r(J,{show:t.userPlaytomicOpen,onClose:e[2]||(e[2]=s=>t.userPlaytomicOpen=!1),user:t.user,title:l.title},null,8,["show","user","title"]),f(r(p,{label:"Create",onClick:e[3]||(e[3]=s=>t.createOpen=!0),icon:"pi pi-plus"},null,512),[[v,o.can(["user.create"])]]),r(D,{value:n.users.data,paginator:"",rows:n.users.per_page,totalRecords:n.users.total,first:(n.users.current_page-1)*n.users.per_page,onPage:_,tableStyle:"min-width: 50rem",rowsPerPageOptions:[5,10,20,50],sortField:"name",sortOrder:-1},{header:a(()=>[u("div",X,[r(S,null,{default:a(()=>[r(N,null,{default:a(()=>e[7]||(e[7]=[u("i",{class:"pi pi-search"},null,-1)])),_:1,__:[7]}),r(P,{modelValue:t.params.search,"onUpdate:modelValue":e[4]||(e[4]=s=>t.params.search=s),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})])]),empty:a(()=>e[8]||(e[8]=[d(" No data found. ")])),loading:a(()=>e[9]||(e[9]=[d(" Loading data. Please wait. ")])),default:a(()=>[r(i,{header:"No"},{body:a(s=>[d(g(s.index+1),1)]),_:1}),r(i,{field:"name",header:"Name",sortable:""}),r(i,{field:"email",header:"Email",sortable:""}),r(i,{header:"Roles",sortable:""},{body:a(s=>[d(g(s.data.roles.map(c=>c.name).join(", ")),1)]),_:1}),r(i,{field:"created_at",header:"Created",sortable:""}),r(i,{field:"updated_at",header:"Updated",sortable:""}),r(i,{exportable:!1,style:{"min-width":"12rem"}},{body:a(s=>[f(r(p,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:c=>(t.editOpen=!0,t.user=s.data)},null,8,["onClick"]),[[v,o.can(["user.update"])]]),f(r(p,{icon:"pi pi-paypal",outlined:"",rounded:"",class:"mr-2",severity:"info",onClick:c=>(t.userPlaytomicOpen=!0,t.user=s.data)},null,8,["onClick"]),[[v,o.can(["user.update"])]]),f(r(p,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:c=>{m.value=!0,t.user=s.data}},null,8,["onClick"]),[[v,o.can(["user.delete"])]])]),_:1})]),_:1},8,["value","rows","totalRecords","first"]),r(V,{visible:m.value,"onUpdate:visible":e[6]||(e[6]=s=>m.value=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[r(p,{label:"No",icon:"pi pi-times",text:"",onClick:e[5]||(e[5]=s=>m.value=!1)}),r(p,{label:"Yes",icon:"pi pi-check",onClick:x})]),default:a(()=>[u("div",Z,[e[12]||(e[12]=u("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),t.user?(C(),A("span",ee,[e[10]||(e[10]=d("Are you sure you want to delete ")),u("b",null,g(t.user.name),1),e[11]||(e[11]=d("?"))])):q("",!0)])]),_:1},8,["visible"])])]),_:1},8,["items"])}}};export{Pe as default};
