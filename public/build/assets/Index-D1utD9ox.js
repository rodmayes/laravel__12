import{s as M}from"./index-C4lvvraB.js";import{s as R,a as U}from"./index-Cd1VNrMd.js";import{s as j,a as z}from"./index-eTxTr7Xb.js";import{s as F}from"./index-JehCiGv6.js";import{s as E}from"./index-CTi-Lker.js";import{s as K}from"./index-ChyoiKwM.js";import{r as v,T as L,a as w,o as A,i as Y,b as x,w as s,e as n,d as t,K as g,L as _,f,t as C,c as q,g as G,h as H}from"./app-BitM9Esh.js";import{_ as J}from"./AppLayout-CLNBn6lV.js";import Q from"./Create-B17_9PGj.js";import W from"./Edit-BUGMBlHm.js";import{p as X}from"./lodash-DrivzgbU.js";import{l as Z}from"./loadToast-DRzFDdxN.js";import"./index-DYoa0sVQ.js";import"./index-DQLB793R.js";import"./index-DtIMjM1X.js";import"./index-3G90EgRb.js";import"./index-ByyraLLP.js";import"./index-CyWtV5jm.js";import"./index-CxtCzB2E.js";import"./index-dCAdXrLa.js";import"./index-NFWRBMuw.js";import"./index-Dk1_9mQF.js";import"./index-BoR1qmRO.js";import"./DropdownLink-CjHD7zJG.js";import"./index-BRhRa0mV.js";import"./index-BMoRl1xm.js";import"./index-zOfXouO5.js";const ee={class:"card"},te={class:"flex flex-wrap gap-2 items-center justify-between"},oe={class:"text-xl font-bold"},ae={class:"flex items-center gap-4"},se={key:0},Ve={__name:"Index",props:{title:String,filters:Object,perPage:Number},setup(h){const{pickBy:$}=X,r=h;Z();const d=v(!1),y=L({}),p=w([]),o=w({params:{search:r.filters.search,field:r.filters.field,order:r.filters.order,perPage:r.perPage??20,page:1,sort:[{field:"name",order:"asc"}]},createOpen:!1,editOpen:!1,timetable:null}),m=()=>{const a=$(o.params);H.post(route("playtomic.timetables.refreshData"),a).then(e=>{Object.assign(p,e.data.items)})},k=()=>{var a;d.value=!1,y.delete(route("playtomic.timetables.destroy",(a=o.timetable)==null?void 0:a.id),{preserveScroll:!0,onSuccess:()=>{y.reset(),m()},onError:()=>null,onFinish:()=>null})},O=a=>{o.params.page=a.page+1,o.params.perPage=a.rows,m()},P=a=>{var l;const e=(l=a.multiSortMeta)==null?void 0:l.map(u=>({field:u.field,order:u.order===1?"asc":"desc"}));o.params.sort=e,m()},b=()=>m();A(()=>{m()});const S=v([{label:"Playtomic"},{label:r.title,url:route("playtomic.timetables.index")}]);return(a,e)=>{const l=K,u=E,N=z,D=F,I=j,c=U,V=R,B=M;return x(),Y(J,{items:S.value},{default:s(()=>[n("div",ee,[t(u,{class:"mb-4"},{start:s(()=>[g(t(l,{label:"Create",onClick:e[0]||(e[0]=i=>o.createOpen=!0),icon:"pi pi-plus",severity:"success",size:"small"},null,512),[[_,a.can(["playtomic.timetable_create"])]])]),_:1}),t(Q,{show:o.createOpen,onClose:e[1]||(e[1]=i=>o.createOpen=!1),title:r.title,onUpdated:b},null,8,["show","title"]),t(W,{show:o.editOpen,onClose:e[2]||(e[2]=i=>o.editOpen=!1),timetable:o.timetable,title:r.title,onUpdated:b},null,8,["show","timetable","title"]),t(V,{value:p.data,lazy:"",paginator:"",rows:p.per_page,totalRecords:p.total,first:(p.current_page-1)*p.per_page,rowsPerPageOptions:[5,10,20,50],sortMode:"multiple",onPage:O,onSort:P,tableStyle:"min-width: 50rem",size:"small"},{header:s(()=>[n("div",te,[n("span",oe,C(r.title),1),t(I,null,{default:s(()=>[t(N,null,{default:s(()=>e[6]||(e[6]=[n("i",{class:"pi pi-search"},null,-1)])),_:1,__:[6]}),t(D,{modelValue:o.params.search,"onUpdate:modelValue":e[3]||(e[3]=i=>o.params.search=i),placeholder:"Keyword Search",onInput:m},null,8,["modelValue"])]),_:1})])]),paginatorstart:s(()=>[t(l,{type:"button",icon:"pi pi-refresh",text:"",onClick:b})]),empty:s(()=>e[7]||(e[7]=[f(" No data found. ")])),loading:s(()=>e[8]||(e[8]=[f(" Loading data. Please wait. ")])),default:s(()=>[t(c,{header:"No",field:"id",sortable:""}),t(c,{field:"name",header:"Name",sortable:""}),t(c,{field:"playtomic_id",header:"PlaytomicId",sortable:""}),t(c,{field:"playtomic_id_summer",header:"PlaytomicId Summer",sortable:""}),t(c,{exportable:!1,style:{"min-width":"12rem"}},{body:s(i=>[g(t(l,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:T=>(o.editOpen=!0,o.timetable=i.data)},null,8,["onClick"]),[[_,a.can(["playtomic.timetable_edit"])]]),g(t(l,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:T=>{d.value=!0,o.timetable=i.data}},null,8,["onClick"]),[[_,a.can(["playtomic.timetable_delete"])]])]),_:1})]),_:1},8,["value","rows","totalRecords","first"]),t(B,{visible:d.value,"onUpdate:visible":e[5]||(e[5]=i=>d.value=i),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[t(l,{label:"No",icon:"pi pi-times",text:"",onClick:e[4]||(e[4]=i=>d.value=!1)}),t(l,{label:"Yes",icon:"pi pi-check",onClick:k})]),default:s(()=>[n("div",ae,[e[11]||(e[11]=n("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),o.timetable?(x(),q("span",se,[e[9]||(e[9]=f("Are you sure you want to delete ")),n("b",null,C(o.timetable.name),1),e[10]||(e[10]=f("?"))])):G("",!0)])]),_:1},8,["visible"])])]),_:1},8,["items"])}}};export{Ve as default};
