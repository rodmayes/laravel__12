import{s as T}from"./index-Be9g_1Eo.js";import{s as F,a as R}from"./index-BCR3EMA2.js";import{s as U,a as j}from"./index-BHVtOMWe.js";import{s as z}from"./index-DnFyHfri.js";import{s as E}from"./index-CXvUAMhg.js";import{s as A}from"./index-BfHKTmDq.js";import{F as v,T as G,G as w,M as H,c as J,o as x,w as s,b as n,a as t,I as g,J as _,e as f,t as C,f as K,g as L,H as Y}from"./app-CB0dyodM.js";import{_ as q}from"./AppLayout-Bnt65DdT.js";import Q from"./Create-aaypHJzf.js";import W from"./Edit-A6ejEKAm.js";import{p as X}from"./lodash-C0G_UMP2.js";import{l as Z}from"./loadToast-TseNTzfy.js";import"./index-3fzsDt9u.js";import"./index-slZyNfaV.js";import"./index-CC8WqAJb.js";import"./index-B_9G0EJD.js";import"./index-BeX3UZgX.js";import"./index-o8mNz6P9.js";import"./index-Es7jeU_p.js";import"./index-B5Q9vJ-u.js";import"./index-BGxCxXkL.js";import"./index-BeJhA7-m.js";import"./index-DF0TcBff.js";import"./index-B56-Iuev.js";import"./DropdownLink-DZXjjQov.js";import"./index-B3G1jHyt.js";import"./index-D5cDUAcg.js";import"./index-BcyB5M4q.js";const ee={class:"card"},te={class:"flex flex-wrap gap-2 items-center justify-between"},oe={class:"text-xl font-bold"},ae={class:"flex items-center gap-4"},se={key:0},Be={__name:"Index",props:{title:String,filters:Object,perPage:Number},setup($){const{pickBy:h}=X,r=$;Z();const d=v(!1),y=G({}),p=w([]),o=w({params:{search:r.filters.search,field:r.filters.field,order:r.filters.order,perPage:r.perPage??20,page:1,sort:[{field:"name",order:"asc"}]},createOpen:!1,editOpen:!1,timetable:null}),m=()=>{const a=h(o.params);Y.post(route("playtomic.timetables.refreshData"),a).then(e=>{Object.assign(p,e.data.items)})},k=()=>{var a;d.value=!1,y.delete(route("playtomic.timetables.destroy",(a=o.timetable)==null?void 0:a.id),{preserveScroll:!0,onSuccess:()=>{y.reset(),m()},onError:()=>null,onFinish:()=>null})},O=a=>{o.params.page=a.page+1,o.params.perPage=a.rows,m()},P=a=>{var l;const e=(l=a.multiSortMeta)==null?void 0:l.map(u=>({field:u.field,order:u.order===1?"asc":"desc"}));o.params.sort=e,m()},b=()=>m();H(()=>{m()});const S=v([{label:"Playtomic"},{label:r.title,url:route("playtomic.timetables.index")}]);return(a,e)=>{const l=A,u=E,I=j,N=z,D=U,c=R,V=F,B=T;return x(),J(q,{items:S.value},{default:s(()=>[n("div",ee,[t(u,{class:"mb-4"},{start:s(()=>[g(t(l,{label:"Create",onClick:e[0]||(e[0]=i=>o.createOpen=!0),icon:"pi pi-plus",severity:"success",size:"small"},null,512),[[_,a.can(["playtomic.timetable_create"])]])]),_:1}),t(Q,{show:o.createOpen,onClose:e[1]||(e[1]=i=>o.createOpen=!1),title:r.title,onUpdated:b},null,8,["show","title"]),t(W,{show:o.editOpen,onClose:e[2]||(e[2]=i=>o.editOpen=!1),timetable:o.timetable,title:r.title,onUpdated:b},null,8,["show","timetable","title"]),t(V,{value:p.data,lazy:"",paginator:"",rows:p.per_page,totalRecords:p.total,first:(p.current_page-1)*p.per_page,rowsPerPageOptions:[5,10,20,50],sortMode:"multiple",onPage:O,onSort:P,tableStyle:"min-width: 50rem",size:"small"},{header:s(()=>[n("div",te,[n("span",oe,C(r.title),1),t(D,null,{default:s(()=>[t(I,null,{default:s(()=>e[6]||(e[6]=[n("i",{class:"pi pi-search"},null,-1)])),_:1,__:[6]}),t(N,{modelValue:o.params.search,"onUpdate:modelValue":e[3]||(e[3]=i=>o.params.search=i),placeholder:"Keyword Search",onInput:m},null,8,["modelValue"])]),_:1})])]),paginatorstart:s(()=>[t(l,{type:"button",icon:"pi pi-refresh",text:"",onClick:b})]),empty:s(()=>e[7]||(e[7]=[f(" No data found. ")])),loading:s(()=>e[8]||(e[8]=[f(" Loading data. Please wait. ")])),default:s(()=>[t(c,{header:"No",field:"id",sortable:""}),t(c,{field:"name",header:"Name",sortable:""}),t(c,{field:"playtomic_id",header:"PlaytomicId",sortable:""}),t(c,{field:"playtomic_id_summer",header:"PlaytomicId Summer",sortable:""}),t(c,{exportable:!1,style:{"min-width":"12rem"}},{body:s(i=>[g(t(l,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:M=>(o.editOpen=!0,o.timetable=i.data)},null,8,["onClick"]),[[_,a.can(["playtomic.timetable_edit"])]]),g(t(l,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:M=>{d.value=!0,o.timetable=i.data}},null,8,["onClick"]),[[_,a.can(["playtomic.timetable_delete"])]])]),_:1})]),_:1},8,["value","rows","totalRecords","first"]),t(B,{visible:d.value,"onUpdate:visible":e[5]||(e[5]=i=>d.value=i),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[t(l,{label:"No",icon:"pi pi-times",text:"",onClick:e[4]||(e[4]=i=>d.value=!1)}),t(l,{label:"Yes",icon:"pi pi-check",onClick:k})]),default:s(()=>[n("div",ae,[e[11]||(e[11]=n("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),o.timetable?(x(),K("span",se,[e[9]||(e[9]=f("Are you sure you want to delete ")),n("b",null,C(o.timetable.name),1),e[10]||(e[10]=f("?"))])):L("",!0)])]),_:1},8,["visible"])])]),_:1},8,["items"])}}};export{Be as default};
