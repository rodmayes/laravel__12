import{s as w}from"./index-Cwf3xXSf.js";import{s as B,_ as O}from"./AppLayout-hxMZJ4a3.js";import{s as $}from"./index-jrJKlSHv.js";import{s as L}from"./index-UnlfduWp.js";import{F as m,G as M,M as N,c as b,o as g,w as f,b as j,a as n,H as U,u as v,Y as p,I as T,L as x}from"./app-BUGNN5JA.js";import I from"./BookingTable-DwLXDFY1.js";import R from"./BookingCards-CYvwJuZT.js";import{l as z}from"./loadToast-CkDWCmsi.js";import{p as A}from"./lodash-Cw7HC34c.js";import{g as F,a as G}from"./useFormatters-DGNKrJCF.js";import"./index-U_6rZySG.js";import"./index-BKQe30te.js";import"./index-E7fOk3yg.js";import"./index-DMS4686z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CH1mWxBr.js";import"./index-BO7XlLjM.js";import"./index-BH19Py2R.js";import"./index-Dfx5MwNy.js";import"./index-CulZY4AK.js";import"./index-D7AR1XY8.js";import"./index-C0RVGQQ7.js";import"./index-DTCRZRZj.js";import"./index-Cg18yx5v.js";import"./index-WnxEPr5W.js";import"./index-D7tzdrL0.js";import"./index-BOfvppdX.js";import"./index-Nr5CUFq_.js";import"./index-DFxtE1fo.js";import"./index-BLljuaDF.js";const H={class:"card"},he={__name:"Index",props:{title:String,filters:Object,clubs:Object,players:Object,timetables:Object,perPage:Number},setup(k){const{pickBy:_}=A;z();const i=k,u=m([]),d=m("card"),D=m([{name:"On time",value:"on-time"},{name:"Closed",value:"closed"},{name:"Time Out",value:"time-out"}]),a=M({params:{search:i.filters.search,perPage:i.perPage??20,club:null,status:"on-time",player:null,timetable:null,page:1,sort:[{field:"started_at",order:"desc"}]},booking:null}),c=m(!1),t=()=>{const o=_(a.params,e=>e!=null);x.post(route("playtomic.bookings.refreshData"),o).then(e=>{u.value={...e.data.items,data:e.data.items.data.map(r=>{const l=F(r);return{...r,modified_at:l?G(l):null}})}})},y=o=>{a.params.page=o.page+1,a.params.perPage=o.rows,t()},V=o=>{var r;const e=(r=o.multiSortMeta)==null?void 0:r.map(l=>({field:l.field,order:l.order===1?"asc":"desc"}));a.params.sort=JSON.stringify(e),t()},C=()=>{p.delete(route("playtomic.bookings.destroy",a.booking.id),{onSuccess:()=>{c.value=!1,t()}})},S=m([{label:"Playtomic"},{label:i.title,url:route("playtomic.bookings.index")}]);return N(t),(o,e)=>{const r=L,l=$,h=B,P=w;return g(),b(O,{items:S.value},{default:f(()=>[j("div",H,[n(P,{class:"mb-4"},{start:f(()=>[U(n(r,{label:"Add Booking",icon:"pi pi-plus",severity:"success",size:"small",onClick:e[0]||(e[0]=s=>v(p).visit(o.route("playtomic.bookings.create")))},null,512),[[T,o.can(["playtomic.booking_create"])]])]),end:f(()=>[n(l,{modelValue:a.params.club,"onUpdate:modelValue":e[1]||(e[1]=s=>a.params.club=s),options:i.clubs,optionLabel:"name",optionValue:"id",placeholder:"Club",class:"mr-2",showClear:"",onChange:t},null,8,["modelValue","options"]),n(l,{modelValue:a.params.player,"onUpdate:modelValue":e[2]||(e[2]=s=>a.params.player=s),options:i.players,optionLabel:"name",optionValue:"id",placeholder:"Player",class:"mr-2",showClear:"",onChange:t},null,8,["modelValue","options"]),n(h,{modelValue:a.params.status,"onUpdate:modelValue":e[3]||(e[3]=s=>a.params.status=s),options:D.value,optionLabel:"name",optionValue:"value",class:"mr-2",onChange:t},null,8,["modelValue","options"]),n(h,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=s=>d.value=s),options:[{label:"Table",value:"table"},{label:"Cards",value:"card"}],optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),_:1}),d.value==="table"?(g(),b(I,{key:0,items:u.value,deleteDialog:c.value,data:a,onPageChange:y,onSortChange:V,onRefresh:t,deleteData:C,router:v(p),can:o.can},null,8,["items","deleteDialog","data","router","can"])):(g(),b(R,{key:1,items:u.value,deleteDialog:c.value,data:a,onPageChange:y,onSortChange:V,onRefresh:t,deleteData:C,router:v(p),can:o.can},null,8,["items","deleteDialog","data","router","can"]))])]),_:1},8,["items"])}}};export{he as default};
