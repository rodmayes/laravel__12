import{s as w}from"./index-BiF9-PBE.js";import{s as B,_ as O}from"./AppLayout-6OaO2hl8.js";import{s as $}from"./index-CZEovE7T.js";import{s as L}from"./index-BB_-LLQi.js";import{F as m,G as M,M as N,c as b,o as g,w as v,b as j,a as n,H as U,u as y,Y as u,I as T,L as x}from"./app-Du-Da1Lm.js";import I from"./BookingTable-B4eCK6OE.js";import R from"./BookingCards-BCh-alBd.js";import{l as z}from"./loadToast-tJE88aRQ.js";import{p as A}from"./lodash-54nS7jGL.js";import{g as F,a as G}from"./useFormatters-DGNKrJCF.js";import"./index-DWaj-m-B.js";import"./index-C-pumLhE.js";import"./index-BTzytkdh.js";import"./index-DRjgY8BA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-Cjb_ulgo.js";import"./index-BcnvJR1F.js";import"./index-B_-Q1jnc.js";import"./index-CrayQXN3.js";import"./index-yEhKem5U.js";import"./index-W8AoM2Af.js";import"./index-pBsfNJa7.js";import"./index-C2M2wQ7G.js";import"./index-BUmdLZTI.js";import"./index-vF3WrHEb.js";import"./index-96G423Ij.js";import"./index-CmWNe62F.js";import"./index-C9-Cej4A.js";import"./index-Bv9B3atk.js";import"./index-D-kdfrWV.js";const H={class:"card"},he={__name:"Index",props:{title:String,filters:Object,clubs:Object,players:Object,timetables:Object,perPage:Number},setup(D){const{pickBy:k}=A;z();const i=D,d=m([]),c=m("card"),_=m([{name:"On time",value:"on-time"},{name:"Closed",value:"closed"},{name:"Time Out",value:"time-out"}]),o=M({params:{search:i.filters.search,perPage:i.perPage??20,club:null,status:"on-time",player:null,timetable:null,page:1,sort:[{field:"started_at",order:"desc"}]},booking:null}),f=m(!1),t=()=>{const a=k(o.params,e=>e!=null);x.post(route("playtomic.bookings.refreshData"),a).then(e=>{d.value={...e.data.items,data:e.data.items.data.map(r=>{const l=F(r);return{...r,modified_at:l?G(l):null}})}})},C=a=>{o.params.page=a.page+1,o.params.perPage=a.rows,t()},V=a=>{var r;const e=(r=a.multiSortMeta)==null?void 0:r.map(l=>({field:l.field,order:l.order===1?"asc":"desc"}));o.params.sort=JSON.stringify(e),t()},p=a=>{u.delete(route("playtomic.bookings.destroy",a.id),{onSuccess:()=>{f.value=!1,t()}})},S=m([{label:"Playtomic"},{label:i.title,url:route("playtomic.bookings.index")}]);return N(t),(a,e)=>{const r=L,l=$,h=B,P=w;return g(),b(O,{items:S.value},{default:v(()=>[j("div",H,[n(P,{class:"mb-4"},{start:v(()=>[U(n(r,{label:"Add Booking",icon:"pi pi-plus",severity:"success",size:"small",onClick:e[0]||(e[0]=s=>y(u).visit(a.route("playtomic.bookings.create")))},null,512),[[T,a.can(["playtomic.booking_create"])]])]),end:v(()=>[n(l,{modelValue:o.params.club,"onUpdate:modelValue":e[1]||(e[1]=s=>o.params.club=s),options:i.clubs,optionLabel:"name",optionValue:"id",placeholder:"Club",class:"mr-2",showClear:"",onChange:t},null,8,["modelValue","options"]),n(l,{modelValue:o.params.player,"onUpdate:modelValue":e[2]||(e[2]=s=>o.params.player=s),options:i.players,optionLabel:"name",optionValue:"id",placeholder:"Player",class:"mr-2",showClear:"",onChange:t},null,8,["modelValue","options"]),n(h,{modelValue:o.params.status,"onUpdate:modelValue":e[3]||(e[3]=s=>o.params.status=s),options:_.value,optionLabel:"name",optionValue:"value",class:"mr-2",onChange:t},null,8,["modelValue","options"]),n(h,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=s=>c.value=s),options:[{label:"Table",value:"table"},{label:"Cards",value:"card"}],optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),_:1}),c.value==="table"?(g(),b(I,{key:0,items:d.value,deleteDialog:f.value,data:o,onPageChange:C,onSortChange:V,onRefresh:t,deleteData:p,router:y(u),can:a.can,onConfirmDelete:p},null,8,["items","deleteDialog","data","router","can"])):(g(),b(R,{key:1,items:d.value,deleteDialog:f.value,data:o,onPageChange:C,onSortChange:V,onRefresh:t,deleteData:p,router:y(u),can:a.can,onConfirmDelete:p},null,8,["items","deleteDialog","data","router","can"]))])]),_:1},8,["items"])}}};export{he as default};
