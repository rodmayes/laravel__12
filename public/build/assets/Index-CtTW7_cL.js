import{s as B}from"./index-Be9g_1Eo.js";import{s as N}from"./index-CXvUAMhg.js";import{s as O,_ as M}from"./AppLayout-Bnt65DdT.js";import{s as L}from"./index-CC8WqAJb.js";import{s as U}from"./index-BfHKTmDq.js";import{F as p,G as j,M as T,c as k,o as c,w as u,b,a as n,I as A,u as y,Y as f,J as I,f as J,g as R,e as S,t as Y,H as z}from"./app-CB0dyodM.js";import E from"./BookingTable-D1NoND-g.js";import F from"./BookingCards-CNjDxn0f.js";import{l as G}from"./loadToast-TseNTzfy.js";import{p as H}from"./lodash-C0G_UMP2.js";import{g as q,a as K}from"./useFormatters-DpE799yv.js";import"./index-BGxCxXkL.js";import"./index-o8mNz6P9.js";import"./index-Es7jeU_p.js";import"./index-B5Q9vJ-u.js";import"./DropdownLink-DZXjjQov.js";import"./index-B3G1jHyt.js";import"./index-D5cDUAcg.js";import"./index-B56-Iuev.js";import"./index-3fzsDt9u.js";import"./index-B_9G0EJD.js";import"./index-BHVtOMWe.js";import"./index-DnFyHfri.js";import"./index-BCR3EMA2.js";import"./index-slZyNfaV.js";import"./index-BeX3UZgX.js";import"./index-BeJhA7-m.js";import"./index-DF0TcBff.js";import"./index-Ckk00FTr.js";const Q={class:"card"},W={class:"flex items-center gap-4"},X={key:0},$e={__name:"Index",props:{title:String,filters:Object,clubs:Object,players:Object,timetables:Object,perPage:Number},setup(P){const{pickBy:w}=H;G();const m=P,g=p([]),v=p("card"),x=p([{name:"On time",value:"on-time"},{name:"Closed",value:"closed"},{name:"Time Out",value:"time-out"}]),o=j({params:{search:m.filters.search,perPage:m.perPage??20,club:null,status:"on-time",player:null,timetable:null,page:1,sort:[{field:"started_at",order:"desc"}]},booking:null}),i=p(!1),l=()=>{const t=w(o.params,e=>e!=null);z.post(route("playtomic.bookings.refreshData"),t).then(e=>{g.value={...e.data.items,data:e.data.items.data.map(s=>{const r=q(s);return{...s,modified_at:r?K(r):null}})}})},C=t=>{o.params.page=t.page+1,o.params.perPage=t.rows,l()},V=t=>{var s;const e=(s=t.multiSortMeta)==null?void 0:s.map(r=>({field:r.field,order:r.order===1?"asc":"desc"}));o.params.sort=JSON.stringify(e),l()},d=()=>{i.value=!1,f.delete(route("playtomic.bookings.destroy",o.booking.id),{onSuccess:()=>{i.value=!1,l()}})},_=p([{label:"Playtomic"},{label:m.title,url:route("playtomic.bookings.index")}]);return T(l),(t,e)=>{const s=U,r=L,D=O,$=N,h=B;return c(),k(M,{items:_.value},{default:u(()=>[b("div",Q,[n($,{class:"mb-4"},{start:u(()=>[A(n(s,{label:"Add Booking",icon:"pi pi-plus",severity:"success",size:"small",onClick:e[0]||(e[0]=a=>y(f).visit(t.route("playtomic.bookings.create")))},null,512),[[I,t.can(["playtomic.booking_create"])]])]),end:u(()=>[n(r,{modelValue:o.params.club,"onUpdate:modelValue":e[1]||(e[1]=a=>o.params.club=a),options:m.clubs,optionLabel:"name",optionValue:"id",placeholder:"Club",class:"mr-2",showClear:"",onChange:l},null,8,["modelValue","options"]),n(r,{modelValue:o.params.player,"onUpdate:modelValue":e[2]||(e[2]=a=>o.params.player=a),options:m.players,optionLabel:"name",optionValue:"id",placeholder:"Player",class:"mr-2",showClear:"",onChange:l},null,8,["modelValue","options"]),n(D,{modelValue:o.params.status,"onUpdate:modelValue":e[3]||(e[3]=a=>o.params.status=a),options:x.value,optionLabel:"name",optionValue:"value",class:"mr-2",onChange:l},null,8,["modelValue","options"]),n(D,{modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),options:[{label:"Table",value:"table"},{label:"Cards",value:"card"}],optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),_:1}),v.value==="table"?(c(),k(E,{key:0,items:g.value,deleteDialog:i.value,data:o,onPageChange:C,onSortChange:V,onRefresh:l,deleteData:d,router:y(f),can:t.can,onConfirmDelete:d},null,8,["items","deleteDialog","data","router","can"])):(c(),k(F,{key:1,items:g.value,deleteDialog:i.value,data:o,onPageChange:C,onSortChange:V,onRefresh:l,deleteData:d,router:y(f),can:t.can,onConfirmDelete:e[5]||(e[5]=a=>{i.value=!0,o.booking=a})},null,8,["items","deleteDialog","data","router","can"]))]),n(h,{visible:i.value,"onUpdate:visible":e[7]||(e[7]=a=>i.value=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:u(()=>[n(s,{label:"No",icon:"pi pi-times",text:"",onClick:e[6]||(e[6]=a=>i.value=!1)}),n(s,{label:"Yes",icon:"pi pi-check",onClick:d})]),default:u(()=>[b("div",W,[e[10]||(e[10]=b("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),o.booking?(c(),J("span",X,[e[8]||(e[8]=S("Are you sure you want to delete ")),b("b",null,Y(o.booking.name),1),e[9]||(e[9]=S("?"))])):R("",!0)])]),_:1},8,["visible"])]),_:1},8,["items"])}}};export{$e as default};
