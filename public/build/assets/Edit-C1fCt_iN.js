import{s as D}from"./index-D_Abxerg.js";import{s as U}from"./index-BUNM_beL.js";import{s as O}from"./index-79c1GUNE.js";import{T as $,S as F,p as S,b as i,w as b,e as s,q as I,d as p,c as d,g as _,u as a,t as c,F as x,j as g,f as C}from"./app-BxDWh9sJ.js";import{l as T}from"./loadToast-DUYPYtFh.js";import"./index-CNIqUNf5.js";import"./index-B-3qvxa5.js";import"./index-4MPmKNJR.js";import"./index-cr_iwp2r.js";import"./index-DCn_lInP.js";const J={class:"flex flex-col gap-4"},Y={class:"flex flex-col lg:flex-row gap-10 items-start justify-center w-full"},q={class:"flex flex-col gap-2"},A={key:0,class:"text-red-500"},G={class:"flex flex-col gap-2 flex-1"},L={class:"flex flex-col gap-2"},M={key:0,class:"text-red-500"},P={class:"flex flex-col gap-2"},W={class:"flex flex-wrap gap-2 max-w-full overflow-x-auto"},z={key:0,class:"text-red-500"},H={class:"flex justify-end gap-2"},ae={__name:"Edit",props:{show:Boolean,title:String,result:Object},emits:["close"],setup(N,{emit:E}){const{toast:f}=T(),n=N,v=E,e=$({date_at:"",numbers:[],complementary:null}),V=()=>{var t;if(e.numbers.length!==6){f.add({severity:"error",summary:"Error",detail:"You must select exactly 6 numbers",life:3e3});return}if(!e.complementary){f.add({severity:"error",summary:"Error",detail:"You must select one complementary number",life:3e3});return}const r={date_at:e.date_at instanceof Date?e.date_at.toISOString().slice(0,10):e.date_at,numbers:JSON.stringify(e.numbers),complementary:e.complementary};e.put(route("lottery.results.update",(t=n.result)==null?void 0:t.id),{...r,preserveScroll:!0,onSuccess:()=>{v("close"),e.reset()},onError:()=>{var m;if(e.response&&e.response.status===500){const l=((m=e.response.data)==null?void 0:m.message)||"Unexpected error";f.add({severity:"error",summary:"Server Error",detail:l,life:4e3})}},onFinish:()=>null})},j=r=>{const t=e.numbers.indexOf(r);t===-1?e.numbers.length<6&&e.numbers.push(r):e.numbers.splice(t,1)},w=Array.from({length:49},(r,t)=>t+1),h=[];for(let r=0;r<w.length;r+=10)h.push(w.slice(r,r+10));const B=r=>{e.complementary=r};return F(()=>{var r,t;if(n.show){e.errors={},e.date_at=(r=n.result)!=null&&r.date_at?new Date(n.result.date_at):null;try{let l=((t=n.result)!=null&&t.numbers?JSON.parse(n.result.numbers):[]).map(y=>parseInt(y));e.numbers=l.slice(0,6),e.complementary=l.length>6?l[6]:null}catch{e.numbers=[],e.complementary=null}}}),(r,t)=>{const m=O,l=U,y=D;return i(),S(y,{visible:n.show,"onUpdate:visible":t[2]||(t[2]=o=>n.show=o),position:"top",modal:"",header:"Update "+n.title,style:{width:"60rem"},closable:!1},{default:b(()=>[s("form",{onSubmit:I(V,["prevent"])},[s("div",J,[s("div",Y,[s("div",q,[t[3]||(t[3]=s("label",{for:"date_at"},"Date",-1)),p(m,{modelValue:a(e).date_at,"onUpdate:modelValue":t[0]||(t[0]=o=>a(e).date_at=o),inline:"",dateFormat:"yy-mm-dd",touchUI:!1,showIcon:!1,class:"w-full lg:w-[20rem] min-w-[18rem]",style:{minWidth:"18rem"}},null,8,["modelValue"]),a(e).errors.date_at?(i(),d("small",A,c(a(e).errors.date_at),1)):_("",!0)]),s("div",G,[t[4]||(t[4]=s("label",{for:"numbers"},"Numbers (select 6 from 1â€“49)",-1)),s("div",L,[(i(),d(x,null,g(h,(o,k)=>s("div",{key:"row-"+k,class:"flex flex-wrap gap-2"},[(i(!0),d(x,null,g(o,u=>(i(),S(l,{key:"btn-"+u,onClick:K=>j(u),severity:a(e).numbers.includes(u)?"":"secondary",class:"w-10 h-10 text-sm font-semibold rounded-md border transition-all flex items-center justify-center border-gray-300 dark:border-gray-600"},{default:b(()=>[C(c(u),1)]),_:2},1032,["onClick","severity"]))),128))])),64))]),a(e).errors.numbers?(i(),d("small",M,c(a(e).errors.numbers),1)):_("",!0)])]),s("div",P,[t[5]||(t[5]=s("label",{for:"complementary"},"Complementary Number (select one)",-1)),s("div",W,[(i(),d(x,null,g(49,o=>p(l,{key:"complementary-"+o,onClick:k=>B(o),severity:a(e).complementary===o?"":"secondary",class:"w-10 h-10 text-sm font-semibold rounded-md border transition-all flex items-center justify-center border-gray-300 dark:border-gray-600"},{default:b(()=>[C(c(o),1)]),_:2},1032,["onClick","severity"])),64))]),a(e).errors.complementary?(i(),d("small",z,c(a(e).errors.complementary),1)):_("",!0)]),s("div",H,[p(l,{type:"button",label:"Cancel",severity:"secondary",onClick:t[1]||(t[1]=o=>v("close"))}),p(l,{type:"submit",label:"Update"})])])],32)]),_:1},8,["visible","header"])}}};export{ae as default};
